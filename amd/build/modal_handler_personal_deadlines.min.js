define("mod_coursework/modal_handler_personal_deadlines",["exports","core_form/modalform","core/notification","core/str","core/log","mod_coursework/modal_grading_table_ui"],(function(_exports,_modalform,_notification,_str,_log,_modal_grading_table_ui){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Javascript module for handling personal extension modal.
   *
   * @module      mod_coursework/modal_handler_personal_deadlines
   * @copyright   2025 UCL
   * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */let courseworkId;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_modalform=_interopRequireDefault(_modalform),_notification=_interopRequireDefault(_notification),_log=_interopRequireDefault(_log);_exports.init=courseworkid=>{courseworkId=courseworkid;const tableSelector="#mod-coursework-submissions-table-".concat(courseworkId),triggerElement=document.querySelector(tableSelector),actionSelector='[data-action="mod-coursework-launch-modal-personal-deadline"]';triggerElement.addEventListener("click",(event=>{var _dataSet$courseworkId;const actionMenu=event.srcElement.matches(actionSelector)?event.srcElement:event.srcElement.closest(actionSelector),rowElement=event.srcElement.closest("tr");if(!actionMenu)return;event.preventDefault();const dataSet=actionMenu.dataset;if(null!==(_dataSet$courseworkId=!dataSet.courseworkId)&&void 0!==_dataSet$courseworkId&&_dataSet$courseworkId)return void _log.default.error("Insufficient data to process personal deadline request.");const args={courseworkid:courseworkId,allocatableid:dataSet.allocatableId,allocatabletype:dataSet.allocatableType,deadlineid:dataSet.deadlineId},modalForm=new _modalform.default({modalConfig:{title:(0,_str.getString)("extended_deadline","mod_coursework")},formClass:"mod_coursework\\forms\\personal_deadline_form",saveButtonText:(0,_str.getString)("save","core"),returnFocus:triggerElement,args:args});modalForm.addEventListener(modalForm.events.FORM_SUBMITTED,(event=>{if(event.detail.success){if("saved"===event.detail.resultcode)try{(0,_modal_grading_table_ui.replaceRow)(rowElement,dataSet,event.detail.message)}catch(e){_notification.default.addNotification({type:"error",message:e.message})}}else if(event.detail.errors)_notification.default.addNotification({type:"error",message:event.detail.errors.join("<br>")});else if(event.detail.warnings){const warningMessages=event.detail.warnings.map((warning=>warning.message));_notification.default.addNotification({type:"error",message:warningMessages.join("<br>")})}})),modalForm.show()}))}}));

//# sourceMappingURL=modal_handler_personal_deadlines.min.js.map