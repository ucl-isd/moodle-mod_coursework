define("mod_coursework/modal_handler_allow_late_submissions",["exports","core/notification","core/str","core/toast","core/ajax","mod_coursework/modal_grading_table_ui","core/log"],(function(_exports,_notification,_str,_toast,_ajax,_modal_grading_table_ui,_log){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Javascript module for handling allow late submissions modal.
   *
   * @module      mod_coursework/modal_handler_extensions
   * @copyright   2025 UCL
   * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */let courseworkId;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_notification=_interopRequireDefault(_notification),_ajax=_interopRequireDefault(_ajax),_log=_interopRequireDefault(_log);_exports.init=courseworkid=>{courseworkId=courseworkid;const tableSelector="#mod-coursework-submissions-table-".concat(courseworkId),triggerElement=document.querySelector(tableSelector),actionSelector='[data-action="mod-coursework-launch-modal-allowlatesubmissionsuser"]';triggerElement.addEventListener("click",(event=>{var _dataSet$courseworkId;const actionMenu=event.target.matches(actionSelector)?event.target:event.target.closest(actionSelector),rowElement=event.target.closest("tr");if(!actionMenu)return;event.preventDefault();const dataSet=actionMenu.dataset;if(null!==(_dataSet$courseworkId=!dataSet.courseworkId)&&void 0!==_dataSet$courseworkId&&_dataSet$courseworkId)return void _log.default.error("Insufficient data to process request.");(0,_str.getStrings)([{key:"yes",component:"core"},{key:"no",component:"core"},{key:"allowlatesubmissions",component:"mod_coursework"},{key:"allowlatesubmissionssure",component:"mod_coursework"},{key:"allowlatesubmissionssurerevoke",component:"mod_coursework"}]).then((strings=>{_notification.default.confirm(strings[2],"1"===dataSet.lateSubsAllowed?strings[4]:strings[3],strings[0],strings[1],(async()=>{try{var _wsResult$exception,_wsResult$error;const wsResult=await _ajax.default.call([{methodname:"mod_coursework_allow_late_submissions",args:{courseworkid:parseInt(dataSet.courseworkId),allocatableid:parseInt(dataSet.allocatableId),allocatabletype:dataSet.allocatableType,status:"1"===dataSet.lateSubsAllowed?0:1}}])[0];wsResult.success?(0,_modal_grading_table_ui.replaceRow)(rowElement,dataSet,wsResult.message):null!==(_wsResult$exception=wsResult.exception)&&void 0!==_wsResult$exception&&_wsResult$exception?(0,_toast.add)(wsResult.exception.message,{type:"warning"}):"string"==typeof(null!==(_wsResult$error=wsResult.error)&&void 0!==_wsResult$error?_wsResult$error:null)&&(0,_toast.add)(wsResult.error,{type:"warning"})}catch(e){var _e$message;(0,_toast.add)(null!==(_e$message=e.message)&&void 0!==_e$message?_e$message:e.error,{type:"danger"})}}))}))}))}}));

//# sourceMappingURL=modal_handler_allow_late_submissions.min.js.map