define("mod_coursework/total_mark",["exports"],(function(_exports){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0;
/**
   * Total mark calculation module for mod_coursework.
   *
   * @module     mod_coursework/total_mark
   * @copyright  2026 UCL
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */
const update_ui=(total_score,total_max)=>{const score=+total_score.toFixed(2),max=+total_max.toFixed(2),percent=max>0?score/max*100:0,display_percent=+Math.max(0,Math.min(percent,100)).toFixed(2);document.querySelectorAll('[data-region="total-mark-display"]').forEach((region=>{region.querySelector(".total-score-text").textContent=score.toString(),region.querySelector(".total-max-text").textContent=max.toString(),region.querySelector(".total-percent").textContent=display_percent.toString();const bar=region.querySelector(".total-progress-bar");bar&&(bar.style.width=display_percent+"%",bar.setAttribute("aria-valuenow",score.toString()),bar.setAttribute("aria-valuemax",max.toString()))}))},calculate_rubric=()=>{const rubric=document.querySelector(".gradingform_rubric");if(!rubric)return;let running_total=0,running_max=0;rubric.querySelectorAll(".criterion").forEach((row=>{const selected=row.querySelector(".level.checked .scorevalue");selected&&(running_total+=parseFloat(selected.textContent)||0);let row_max=0;row.querySelectorAll(".scorevalue").forEach((span=>{const val=parseFloat(span.textContent)||0;val>row_max&&(row_max=val)})),running_max+=row_max})),update_ui(running_total,running_max)},calculate_guide=()=>{const guide=document.querySelector(".gradingform_guide");if(!guide)return;let running_total=0,running_max=0;guide.querySelectorAll('.score input[type="number"]').forEach((input=>{const val=parseFloat(input.value),max=parseFloat(input.getAttribute("max"));isNaN(val)||(running_total+=val),isNaN(max)||(running_max+=max)})),update_ui(running_total,running_max)};_exports.init=()=>{const run=()=>{setTimeout((()=>{(()=>{const rubric=document.querySelector(".gradingform_rubric"),guide=document.querySelector(".gradingform_guide");rubric&&(new MutationObserver(calculate_rubric).observe(rubric,{attributes:!0,subtree:!0,attributeFilter:["class"]}),calculate_rubric());guide&&(document.addEventListener("input",(e=>{e.target.closest(".gradingform_guide .score")&&calculate_guide()})),calculate_guide())})()}),50)};"complete"===document.readyState?run():window.addEventListener("load",run)}}));

//# sourceMappingURL=total_mark.min.js.map