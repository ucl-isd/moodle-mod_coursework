define("mod_coursework/modal_handler_plagiarism",["exports","core_form/modalform","core/notification","core/str","mod_coursework/modal_grading_table_ui","core/log"],(function(_exports,_modalform,_notification,_str,_modal_grading_table_ui,_log){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Javascript module for handling plagiarism flags modal.
   *
   * @module      mod_coursework/modal_handler_plagiarism
   * @copyright   2025 UCL
   * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */let courseworkId;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_modalform=_interopRequireDefault(_modalform),_notification=_interopRequireDefault(_notification),_log=_interopRequireDefault(_log);_exports.init=courseworkid=>{courseworkId=courseworkid;const tableSelector="#mod-coursework-submissions-table-".concat(courseworkId),triggerElement=document.querySelector(tableSelector),actionSelector='[data-action="mod-coursework-launch-modal-plagiarism"]';triggerElement.addEventListener("click",(event=>{var _dataSet$courseworkId,_dataSet$plagiarismId;const actionMenu=event.target.matches(actionSelector)?event.target:event.target.closest(actionSelector),rowElement=event.target.closest("tr");if(!actionMenu)return;event.preventDefault();const dataSet=actionMenu.dataset;if(null!==(_dataSet$courseworkId=!dataSet.courseworkId)&&void 0!==_dataSet$courseworkId&&_dataSet$courseworkId)return void _log.default.error("Insufficient data to process extension request.");const args={submissionid:dataSet.submissionId,plagiarismflagid:null!==(_dataSet$plagiarismId=dataSet.plagiarismId)&&void 0!==_dataSet$plagiarismId?_dataSet$plagiarismId:""},modalForm=new _modalform.default({modalConfig:{title:(0,_str.getString)("plagiarismflagging","mod_coursework")},formClass:"mod_coursework\\forms\\plagiarism_flagging_mform",saveButtonText:(0,_str.getString)("save","core"),returnFocus:triggerElement,args:args});modalForm.addEventListener(modalForm.events.FORM_SUBMITTED,(event=>{if(event.detail.success){if("saved"===event.detail.resultcode)try{(0,_modal_grading_table_ui.replaceRow)(rowElement,dataSet,event.detail.message)}catch(e){_notification.default.addNotification({type:"error",message:e.message})}}else if(event.detail.errors)_notification.default.addNotification({type:"error",message:event.detail.errors.join("<br>")});else if(event.detail.warnings){const warningMessages=event.detail.warnings.map((warning=>warning.message));_notification.default.addNotification({type:"error",message:warningMessages.join("<br>")})}})),modalForm.show()}))}}));

//# sourceMappingURL=modal_handler_plagiarism.min.js.map